<%@ page import="requiredjava.DBConnection, java.sql.ResultSet" %>
<%
	if(request.getMethod().equalsIgnoreCase("POST") && request.getParameter("query").equalsIgnoreCase("year")){
		
		
		String year = request.getParameter("year");
		int k;
		ResultSet rs;
		String result = "", count;
		
		// initialize database
		DBConnection.Init();
		
		rs=DBConnection.executeQuery("select Distinct Type from attack_report order by Type");
		
		rs.last();
		String []types = new String[rs.getRow()];
		rs.beforeFirst();
		
		k = 0;
		while(rs.next())
		{
			types[k++] = rs.getString(1);
		}
		rs.close();
		
		String months[] = new String[]{"January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"};
		
		for(int i=0; i<months.length; ++i)
			for(int j=0; j<types.length; ++j){
				rs = DBConnection.executeQuery("select sum(Count) from attack_report where MonthName(Datetime)='"+months[i]+"' and Type='"+types[j]+"' and Year(Datetime)='"+year+"'");
				if(rs.next()){
					count = rs.getString(1);
					if(count == null)
						result += "0:";
					else
						result += count+":";
				}
			}
		
		// destroy database
		DBConnection.destroy();
		
		String finalResult = "";
		
		for(int i=0; i<months.length; ++i)
			finalResult += months[i]+":";
		finalResult += "&&";
		for(int i=0; i<types.length; ++i)
			finalResult += types[i]+":";
		finalResult += "&&";
		finalResult += result;
		
		out.print(finalResult);
	}
	else
		response.sendRedirect("../");
%>