<%
	if(session.getAttribute("userId") == null){
		response.sendRedirect("../");
	}
%>
<%@ page import="requiredjava.*"%>
<%@ page language="java" contentType="text/html; charset=UTF-8"
	pageEncoding="UTF-8"%>
<!DOCTYPE html>
<html dir="ltr" lang="en-US">
<head>

<!-- Required JS & css
	============================================= -->
<jsp:include page="includeHeaders.jsp"></jsp:include>
<!-- Document Title
    ============================================= -->
<title>Home | VAS</title>
</head>
<body class="stretched">
	<!-- Document Wrapper
    ============================================= -->
	<div id="wrapper" class="clearfix">

		<!-- Page Title
        ============================================= -->
		<jsp:include page="../header.jsp"></jsp:include>
		<!-- #page-title end -->

		<!-- Content
        ============================================= -->
		<section id="content">
			<div class="content-wrap" style="padding-top: 0px; padding-bottom: 0px;">
				<div class="container clearfix" style="margin-top: 30px; margin-bottom: 30px;">
					<div class="tabs side-tabs clearfix" id="tab-8">
						<ul class="tab-nav tab-nav2 clearfix">
							<li><a href="#tabs-29"><i
									class="icon-home2 norightmargin"></i> Overview</a></li>
							<li><a href="#tabs-30"><i class="icon-magic"></i> Hadoop
									Daemons</a></li>
							<li><a href="#tabs-31"><i class="icon-wrench"></i> Job
									Schedular</a></li>
							<li><a href="#tabs-32"><i class="icon-external-link"></i>
									Hadoop Interfaces</a></li>
							<li><a href="#tabs-33"><i class="icon-dashboard"></i>
									Reports</a></li>
							<li><a href="#tabs-34"><i class="icon-cog"></i> Settings</a></li>
						</ul>
						<div class="tab-container">
							<!-- ******************************************
								Overview
							******************************************* -->
							<div class="tab-content clearfix" id="tabs-29">
								<div class="heading-block" style="margin-bottom: 20px;">
									<h2>Overview</h2>
									<span>Network Security Solution for Organizations</span>
								</div>
								<div style="border: 1px solid #E5E5E5;border-radius: 3px; padding: 30px; color: #444; font-weight: 300; font-size: 15px;">
									<img class="alignright img-responsive"
										src="../images/green-hadoop-elephant-flipped.png"
										alt="hadoop-image"> <span class="dropcap">S</span>ecurity
									is one of the biggest concerns of any organization that has an
									IT infrastructure. It is very important for an administrator to
									always know the security posture of the network and servers that
									they manage. One way to always know the state of an environment
									is through system logs. <span><b>VAS</b></span> is securiy
									solution for analysing your large data as cloud service on the
									top of Apache Hadoop. It analyzes data using massively parallel
									processing techniques.
								</div>
							</div>
							
							<!-- ******************************************
								Hadoop Daemons
							******************************************* -->
							<div class="tab-content clearfix" id="tabs-30">
								<div class="heading-block" style="margin-bottom:20px;">
									<h2>Start & stop hadoop cluster</h2>
								</div>
								<div class="promo promo-border bottommargin">
									<h3>Start Your Hadoop Cluster</h3>
									<span>It is mandetory to start Apache Hadoop Cluster in
										order send <br />logs for analysis.
									</span>
										<%
											out.print("<a data-trigger='hover' data-container='body' data-toggle='popover' data-placement='bottom' class='button button-xlarge button-rounded' id='startHadoopButton' ");
											out.print(HadoopManipulation.getStatus()?"data-content='Stop all hadoop daemons'> Stop Hadoop</a>":"data-content='Start all hadoop daemons'>Start Hadoop</a>");
										%>
									<a style="display: none;" href="#" id="notification_bar"
										class="btn btn-default" data-notify-position="top-right"
										data-notify-type="success" data-notify-msg="">Top Full
										Width</a>
									<script>
										var notificationAlertBox = $("#notification_bar");
										$("#startHadoopButton").click(
											function(){
												var dataString;
												var clickedButton = $("#startHadoopButton");
												if(clickedButton.text().trim() == "Start Hadoop"){
													dataString="data=start";
													clickedButton.attr("disabled","disabled");
													clickedButton.text("Starting...");
													Pace.track(function(){
														$.ajax({
															type: "POST",
															url: "startStopHadoop.jsp",
															data: dataString,
															cache: false,
															success: function(result){
																notificationAlertBox.attr('data-notify-type', 'success');
																notificationAlertBox.attr("data-notify-msg", "<i class=icon-check-sign></i>Started Successfully !");
																SEMICOLON.widget.notifications(notificationAlertBox);
																clickedButton.text("Stop Hadoop");
																clickedButton.attr('data-content', 'Stop all hadoop daemons');
																clickedButton.removeAttr("disabled");
															}
														})
													});
												}
												else{
													dataString="data=stop";
													clickedButton.attr("disabled","disabled");
													clickedButton.text("Stopping...");
													Pace.track(function(){
														$.ajax({
															type: "POST",
															url: "startStopHadoop.jsp",
															data: dataString,
															cache: false,
															success: function(result){
																notificationAlertBox.attr('data-notify-type', 'success');
																notificationAlertBox.attr("data-notify-msg", "<i class=icon-check-sign></i>Stopped Successfully !");
																SEMICOLON.widget.notifications(notificationAlertBox);
																clickedButton.text("Start Hadoop");
																clickedButton.attr('data-content', 'Start all hadoop daemons');
																clickedButton.removeAttr("disabled");
															}
														})
													});
												}
											});
									</script>
								</div>
							</div>
							
							<!-- ******************************************
								Job Scheduler
							******************************************* -->
							<div class="tab-content clearfix" id="tabs-31">
								<div class="heading-block" style="margin-bottom: 20px;">
									<h2>Schedule your job for analysis</h2>
									<span>Job scheduler is at your service</span>
								</div>
								<div class="promo promo-border" style="margin-bottom: 20px;">
									<h3>Start analyzing logs now</h3>
									<span>
										Analyzer will analyze logs based on different rules available.<br/>rules are nothing but set of regular expression representing pattern of security threat.<br/>Such rules are checked against logs.
									</span>
									<a data-trigger="hover" data-container="body" data-toggle="popover" data-placement="bottom" data-content="Start analyzing available logs" class="button button-xlarge button-rounded" onclick="analyze();">ANALYZE</a>
								</div>
								<script type="text/javascript">
									function analyze(){
										window.location="detailed-reports.jsp?query=currentPeriod";
									}
								</script>
							</div>
							
							<!-- ******************************************
								Hadoop Interfaces
							******************************************* -->
							<div class="tab-content clearfix" id="tabs-32">
								<div class="heading-block" style="margin-bottom:5px;">
									<h2>KNOW MORE ABOUT HADOOP CLUSTER</h2>
									<span>Get health status & running jobs using these interfaces</span>
								</div>
								<div class="nobottommargin">
									<img class="alignleft img-responsive" style="float: none;"
										src="../images/green-hadoop-elephant.png" alt="">
								</div>
								<div class="nobottommargin">
									<a href="
									<%="http://"+request.getServerName()+":50070"%>
									" target="_blank"
										class="button button-desc button-border button-rounded center">
										<div>
											Namenode Interface<span>Check health of hdfs</span>
										</div>
									</a> <a href="
									<%="http://"+request.getServerName()+":8088"%>
									" target="_blank"
										class="button button-desc button-border button-rounded center"><div>
											ResourceManager Interface<span>Detailed job overview</span>
										</div></a>
								</div>
							</div>
							
							<!-- ******************************************
								Reports
							******************************************* -->
							<div class="tab-content clearfix" id="tabs-33">
								<div class="heading-block">
									<h2>Get reports for what you have analyzed</h2>
								</div>
								<div class="row clear-bottommargin">
									<div class="col-md-5 col-sm-12" style="margin-bottom: 5px;">
										<canvas id="barChart"></canvas>
									</div>
									<div class="col-md-5 col-sm-12" style="margin-bottom: 5px;">
										<canvas id="doughnutChart"></canvas>
									</div>
								</div>
								<script src="../js/ChartJS/dist/Chart.bundle.min.js"></script>
								<script type="text/javascript">
									var options = {
										scales : {
											yAxes : [ {
												ticks : {
													beginAtZero : true
												}
											} ]
										}
									};
									var data = {
										labels : [ "January", "February", "March",
												"April", "May", "June", "July" ],
										datasets : [
												{
													label : "WebServer logs",
													backgroundColor : "rgba(255,99,132,0.2)",
													borderColor : "rgba(255,99,132,1)",
													borderWidth : 1,
													hoverBackgroundColor : "rgba(255,99,132,0.4)",
													hoverBorderColor : "rgba(255,99,132,1)",
													data : [ 65, 59, 80, 81, 56, 55, 40 ],
													yAxisID : "y-axis-0",
												},
												{
													label : "System logs",
													backgroundColor : "rgba(54,162,235,0.2)",
													borderColor : "rgba(54,162,235,1)",
													borderWidth : 1,
													hoverBackgroundColor : "rgba(54,162,235,0.4)",
													hoverBorderColor : "rgba(54,162,235,1)",
													data : [ 28, 48, 40, 19, 86, 27, 90 ]
												} ]
									};
									var data2 = {
										labels : [ "172.20.3.20", "172.20.12.4", "172.20.11.14", "172.20.11.50" ],
										datasets : [ {
											data : [ 300, 50, 100, 200 ],
											backgroundColor : [ "#FF6384", "#36A2EB",
													"#FFCE56", "#222" ],
											hoverBackgroundColor : [ "#FF6384",
													"#36A2EB", "#FFCE56", "#222" ]
										} ]
									};
									
									var ctxForBar = document.getElementById("barChart");
									var ctxForDoughnut = document.getElementById("doughnutChart");
									
									window.myBar = new Chart(ctxForBar, {
										type : 'bar',
										data : data,
										options : options
									});
									
									window.myDoughnut = new Chart(ctxForDoughnut, {
										type : 'doughnut',
										data : data2
									});
								</script>
								<div class="nobottommargin">
									<a href="graphical-reports.jsp" target="_blank" class="button button-desc button-border button-rounded center">
											Graphical Overall Reports<span>get the reports in the form of graphical charts</span>
									</a>
									<a href="detailed-reports.jsp?query=nothing" target="_blank" class="button button-desc button-border button-rounded center">
											Detailed Analysis Report<span>get detailed description of attack found</span>
									</a>
								</div>
							</div>
							
							<!-- ******************************************
								Settings
							******************************************* -->
							<div class="tab-content clearfix" id="tabs-34">
								<div class="heading-block" style="margin-bottom: 20px;">
									<h2>Customize Your Profile</h2>
								</div>
								<div class="row clear-bottommargin">
									<div class="col-md-6 col-sm-12" style="margin-bottom: 20px;">
										<div class="promo promo-border promo-mini">
											<h3 style="margin-bottom: 10px;">UPDATE USERNAME</h3>
											<input placeholder="Enter username" data-trigger="focus" data-container="body" data-toggle="popover" data-placement="right" data-content="Enter new username to update."
												style="margin-bottom: 5px;" type="text"
												class="required form-control input-block-level" />
											<button class="update-button button button-rounded button-reveal button-border nomargin tright"><i class="icon-angle-right"></i><span>UPDATE</span></button>
										</div>
									</div>
									<div class="col-md-6 col-sm-12" style="margin-bottom: 20px;">
										<form id="asd">
										<div class="promo promo-border promo-mini">
											<h3 style="margin-bottom: 10px;">UPDATE EMAIL</h3>
											<input placeholder="Enter new Email ID" data-trigger="focus" data-container="body" data-toggle="popover" data-placement="left" data-content="Enter new emailid to update."
												style="margin-bottom: 5px;" type="email"
												class="required form-control input-block-level"/>
											<button class="update-button button button-rounded button-reveal button-border nomargin tright"><i class="icon-angle-right"></i><span>UPDATE</span></button>
										</div>
										</form>
									</div>
									<div class="col-md-6 col-sm-12" style="margin-bottom: 20px;">
										<div class="promo promo-border promo-mini">
											<h3 style="margin-bottom: 10px;">UPDATE PASSWORD</h3>
											<input placeholder="Enter password" data-trigger="focus" data-container="body" data-toggle="popover" data-placement="right" data-content="Enter new password."
												style="margin-bottom: 5px;" type="password"
												class="required form-control input-block-level" />
											<input
												placeholder="Confirm password" data-trigger="focus" data-container="body" data-toggle="popover" data-placement="right" data-content="Confirm entered password."
												style="margin-bottom: 5px;" type="password"
												class="required form-control input-block-level" />
											<button class="update-button button button-rounded button-reveal button-border nomargin tright"><i class="icon-angle-right"></i><span>UPDATE</span></button>
										</div>
									</div>
									<script type="text/javascript">
										$(".update-button").click(
											function(){
												var str = $(this).parent().find("h3").text();
												var dataString;
												switch(str){
													case "UPDATE USERNAME" : 
														var uname = $(this).parent().find("input").val().trim();
														if(uname == ""){
															notificationAlertBox.attr("data-notify-type", "error");
															notificationAlertBox.attr("data-notify-msg", "<i class=icon-remove-sign></i>Please fill username");
	 														SEMICOLON.widget.notifications(notificationAlertBox);
															return false;
														}
														dataString = "query=uname&uname="+uname;
														break;
														
													case "UPDATE EMAIL" :
														var email = $(this).parent().find("input").val().trim();
														if(email == ""){
															notificationAlertBox.attr("data-notify-type", "error");
															notificationAlertBox.attr("data-notify-msg", "<i class=icon-remove-sign></i>Please fill emailid");
	 														SEMICOLON.widget.notifications(notificationAlertBox);
															return false;
														}
														atpos = email.indexOf("@");
														dotpos = email.lastIndexOf(".");
														if (atpos < 1 || ( dotpos - atpos < 2 ))
														{
															notificationAlertBox.attr("data-notify-type", "error");
															notificationAlertBox.attr("data-notify-msg", "<i class=icon-remove-sign></i>Email id isn't correct");
	 														SEMICOLON.widget.notifications(notificationAlertBox);
															return false;
														}
														dataString = "query=email&email="+email;
														break;
														
													case "UPDATE PASSWORD" : 
														var passwd1 = $(this).parent().find("input").val().trim();
														var passwd2 = $(this).parent().find("input").next().val().trim();
														if(passwd1 == "" || passwd2 == ""){
															notificationAlertBox.attr("data-notify-type", "error");
															notificationAlertBox.attr("data-notify-msg", "<i class=icon-remove-sign></i>Please fill all fields");
	 														SEMICOLON.widget.notifications(notificationAlertBox);
															return false;
														}
														if(passwd1 != passwd2){
															notificationAlertBox.attr("data-notify-type", "error");
															notificationAlertBox.attr("data-notify-msg", "<i class=icon-remove-sign></i>Password doen't match");
	 														SEMICOLON.widget.notifications(notificationAlertBox);
															return false;
														}
														dataString = "query=passwd&passwd="+passwd1;
														break;
												}
												
												Pace.track(function(){
													$.ajax({
														type: "POST",
														url: "ProfileUpdationScripts/update-data.jsp",
														data: dataString,
														cache: false,
														success: function(result){
															var recvData = result.trim();
															if(recvData == "error"){
																notificationAlertBox.attr("data-notify-type", "error");
																notificationAlertBox.attr("data-notify-msg", "<i class=icon-remove-sign></i>Unknown error occurred");
		 														SEMICOLON.widget.notifications(notificationAlertBox);
															}else{
																notificationAlertBox.attr("data-notify-type", "success");
																notificationAlertBox.attr("data-notify-msg", "<i class=icon-check-sign></i>"+recvData);
		 														SEMICOLON.widget.notifications(notificationAlertBox);
															}
														}
													})
												});
												return false;
											}
										);
									</script>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</section>
		<!-- #content end -->
		<!-- Footer
        ============================================= -->
		<jsp:include page="../footer.jsp"></jsp:include>
		<!-- #footer end -->

	</div>
	<!-- #wrapper end -->

	<!-- Go To Top
    ============================================= -->
	<div id="gotoTop" class="icon-angle-up"></div>

	<!-- Footer Scripts
    ============================================= -->
	<script type="text/javascript" src="../js/functions.js"></script>
	<script type="text/javascript">$('[data-toggle=popover]').popover();</script>
</body>
</html>